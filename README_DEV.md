
# README_DEV

---

## 21 мая 2025
**Юнит-тесты и мокирование**

### Что сделано
- Разобрался с Mock, AsyncMock, MagicMock и их назначением в тестах.
- Написал и адаптировал тест для register_user с полной цепочкой db.execute → .scalars() → .first().
- Изучил, как работает TestClient() и в каких случаях он нужен.
- Написал тест для authenticate_user с мокированием зависимостей db, PasswordHasher, TokenService.
- Разобрался с assert_called() и assert_awaited() — методами проверки вызова моков.
- Понял, как связаны реальные зависимости и внедрение их через интерфейсы (Dependency Inversion Principle).
- Начал применять принципы чистой архитектуры в тестировании.

### Что планируется сделать дальше
- Закончить тесты на authenticate_user, включая негативные кейсы.
- Написать юнит-тесты для TokenService и PasswordHasher.
- Перейти к написанию API/E2E тестов с использованием TestClient.
- Продолжить реализацию OAuth-авторизации (Google, GitHub).

---

## 20 мая 2025  
**Authentication module**

### Что сделано
- Реализованы эндпоинты регистрации и логина пользователей через email + пароль.  
- Внедрена система хеширования паролей через интерфейс `PasswordHasher` и реализацию `BcryptHasher`.  
- Создан интерфейс `TokenService` с реализацией `JWTTokenService` для работы с JWT-токенами.  
- Использован Dependency Injection через FastAPI `Depends` для подстановки нужных реализаций (фабрики `get_password_hasher()`, `get_token_service()`).  
- Вся бизнес-логика вынесена в слой `services/user_service.py` для чистоты архитектуры.  
- В эндпоинтах (`auth.py`) происходит только валидация запросов и вызов сервисов.  
- Использован Pydantic для валидации входных данных (`UserAuthForm`).  
- Добавлена проверка наличия пользователя при регистрации и корректной аутентификации при логине.  
- Текущая реализация работает с PostgreSQL через AsyncSession SQLAlchemy.

### Что планируется сделать дальше
- Добавить регистрацию и аутентификацию через Google OAuth.  
- Расширить поддержку OAuth-провайдеров (GitHub и другие).  
- Реализовать обработку ошибок и исключений на более детальном уровне.  
- Написать unit-тесты на сервисы и эндпоинты.

---


